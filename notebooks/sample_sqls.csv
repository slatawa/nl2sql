question,sql
How many people are enrolled in CalWorks?,"SELECT  COALESCE(SUM(SAFE_CAST( Person AS INT64)), 0) AS total_beneficiaries FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` where Program = <sq>CalWorks<sq>;"
How many of them live in Nevada County?,SELECT SUM(CAST(Person AS INT64)) AS total_beneficiaries FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` where Level=<sq>County<sq> and Number=<sq>Nevada<sq> and Program = <sq>CalWorks<sq>;
How has participation in CalWorks changed since 2015?,"select  year, sum(total_beneficiaries) as total_beneficiaries, round(ifnull(100 * (sum(total_beneficiaries)/lag(sum(total_beneficiaries)) over(order by year asc) - 1), 0), 2)  AS percentage_change from 
(SELECT fileyear AS year,  SUM(SAFE_CAST( Person   AS INT64)) total_beneficiaries, FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS annual_file WHERE (Program = <sq>CalWorks<sq>) group by year ORDER BY year)
 group by year order by year;"
 How do CalWorks program participation trends differ by race and ethnicity?,"SELECT COALESCE(SUM(SAFE_CAST( White   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_whites_1, COALESCE(SUM(SAFE_CAST( Black   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_blacks_1, COALESCE(SUM(SAFE_CAST( Hispanic   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_hispanics_1, COALESCE(SUM(SAFE_CAST( Asian_PI   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_asian_1, COALESCE(SUM(SAFE_CAST( Native_American   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_native_american_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  WHERE (Program ) = <sq>CalWorks<sq>;"
How have these race and ethnicity trends changed over time?,"SELECT fileyear  AS calhhs_dashboard_2015_2020_annual_data_file_fileyear, COALESCE(SUM(SAFE_CAST( White   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_whites_1, COALESCE(SUM(SAFE_CAST( Black   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_blacks_1, COALESCE(SUM(SAFE_CAST( Hispanic   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_hispanics_1, COALESCE(SUM(SAFE_CAST( Asian_PI   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_asian_1, COALESCE(SUM(SAFE_CAST( Native_American   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_native_american_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS calhhs_dashboard_2015_2020_annual_data_file WHERE (Program ) = <sq>CalWorks<sq> GROUP BY fileyear ORDER BY fileyear;"
Which county has the greatest proportion of CalWorks recipients co-enrolled in at least one additional program?,"SELECT Number AS county, COALESCE(SUM(SAFE_CAST( Person   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` WHERE ((_2_programs ) <> <sq>*1<sq> AND (_2_programs ) <> <sq>*2<sq> AND (_2_programs ) <> <sq>0<sq> OR (_2_programs ) IS NULL) AND (((_3_programs ) <> <sq>*1<sq> AND (_3_programs ) <> <sq>*2<sq> AND (_3_programs ) <> <sq>0<sq> OR (_3_programs ) IS NULL) AND ((_4_programs ) <> <sq>*1<sq> AND (_4_programs ) <> <sq>*2<sq> AND (_4_programs ) <> <sq>0<sq> OR (_4_programs ) IS NULL)) AND (((_5__programs ) <> <sq>*1<sq> AND (_5__programs ) <> <sq>*2<sq> AND (_5__programs ) <> <sq>0<sq> OR (_5__programs ) IS NULL) AND (Level ) = <sq>County<sq> AND (((Number ) <> <sq>County Total<sq> OR (Number ) IS NULL) AND (Program ) = <sq>CalWorks<sq>)) GROUP BY county ORDER BY calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1 DESC LIMIT 1;"
What about three or more additional programs?,"SELECT Number AS county, COALESCE(SUM(SAFE_CAST( Person   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS calhhs_dashboard_2015_2020_annual_data_file WHERE ((_3_programs ) <> <sq>*1<sq> AND (_3_programs ) <> <sq>*2<sq> AND (_3_programs ) <> <sq>0<sq> OR (_3_programs ) IS NULL) AND (((_4_programs ) <> <sq>*1<sq> AND (_4_programs ) <> <sq>*2<sq> AND (_4_programs ) <> <sq>0<sq> OR (_4_programs ) IS NULL) AND ((_5__programs ) <> <sq>*1<sq> AND (_5__programs ) <> <sq>*2<sq> AND (_5__programs ) <> <sq>0<sq> OR (_5__programs ) IS NULL)) AND ((Level ) = <sq>County<sq> AND (((Number ) <> <sq>County Total<sq> OR (Number ) IS NULL) AND (Program ) = <sq>CalWorks<sq>)) GROUP BY county ORDER BY calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1 DESC LIMIT 1;"
Which programs have the highest co-enrollment with CalWorks?,"SELECT COALESCE(SUM(SAFE_CAST( Person   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1, COALESCE(SUM(SAFE_CAST( CalFresh   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_calfresh_1, COALESCE(SUM(SAFE_CAST( Child_Welfare   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_child_welfare_1, COALESCE(SUM(SAFE_CAST( DDS   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_dds_1, COALESCE(SUM(SAFE_CAST( Foster_Care   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_foster_care_1, COALESCE(SUM(SAFE_CAST( IHSS   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_ihss_1, COALESCE(SUM(SAFE_CAST( Medi_Cal   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_medi_cal_1, COALESCE(SUM(SAFE_CAST( WIC   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_wic_1, COALESCE(SUM(SAFE_CAST( CalWorks   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_calworks_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` WHERE (Level ) = <sq>County<sq> AND ((Number ) <> <sq>County Total<sq> OR (Number ) IS NULL) AND (Program ) = <sq>CalWorks<sq>;"
Which programs have the highest co-enrollment with CalWorks?,"SELECT COALESCE(SUM(SAFE_CAST( Person   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_beneficiaries_1, COALESCE(SUM(SAFE_CAST( CalFresh   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_calfresh_1, COALESCE(SUM(SAFE_CAST( Child_Welfare   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_child_welfare_1, COALESCE(SUM(SAFE_CAST( DDS   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_dds_1, COALESCE(SUM(SAFE_CAST( Foster_Care   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_foster_care_1, COALESCE(SUM(SAFE_CAST( IHSS   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_ihss_1, COALESCE(SUM(SAFE_CAST( Medi_Cal   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_medi_cal_1, COALESCE(SUM(SAFE_CAST( WIC   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_wic_1, COALESCE(SUM(SAFE_CAST( CalWorks   AS INT64)), 0) AS calhhs_dashboard_2015_2020_annual_data_file_total_calworks_1 FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` WHERE (Level ) = <sq>County<sq> AND ((Number ) <> <sq>County Total<sq> OR (Number ) IS NULL) AND (Program ) = <sq>CalWorks<sq>;"
What county has the greatest enrollment in CalFresh per capita?,"SELECT Vendor_Location  AS calfresh_redemption_by_county_by_participant_category_data_2010_2018_vendor_location, COALESCE(SUM(SAFE_CAST(( SUBSTR (Total_Cost_Vouchers,2,  (INSTR (Total_Cost_Vouchers, <dq>.<dq>) -2))  ) AS INT64)), 0) AS calfresh_redemption_by_county_by_participant_category_data_2010_2018_total_cost_of_vouchers_1 FROM `cdii-poc.HHS_Program_Counts.calfresh-redemption-by-county-by-participant-category-data-2010-2018`  AS calfresh_redemption_by_county_by_participant_category_data_2010_2018 WHERE (Total_Cost_Vouchers) <> <sq>*<sq> OR (Total_Cost_Vouchers) IS NULL GROUP BY calfresh_redemption_by_county_by_participant_category_data_2010_2018_vendor_location ORDER BY calfresh_redemption_by_county_by_participant_category_data_2010_2018_total_cost_of_vouchers_1 DESC limit 1;"
Which five counties have the lowest number of CalFresh authorized vendors compared to CalFresh participants?,"SELECT Vendor_Location,(vendor_cnt/total_participants)*100 as vendor_participants_ratio FROM
((SELECT TRIM(Vendor_Location) AS Vendor_Location,COALESCE(SUM(SAFE_CAST(_Number_of_Participants_Redeemed_ AS INT64))) as total_participants FROM `cdii-poc.HHS_Program_Counts.calfresh-redemption-by-county-by-participant-category-data-2010-2018`  group by Vendor_Location) as participants
JOIN
(SELECT TRIM(COUNTY) AS COUNTY,count(VENDOR) as vendor_cnt FROM `cdii-poc.HHS_Program_Counts.women-infants-and-children-wic-authorized-vendors` 
group by COUNTY having COUNTY is not null) as vendors
ON UPPER(participants.Vendor_Location)=UPPER(vendors.COUNTY))
WHERE (vendor_cnt/total_participants)*100 is not null
order by vendor_participants_ratio asc limit 5;"
How many Hispanic individuals are served across CalHHS programs?,"SELECT  COALESCE(SUM(SAFE_CAST( Hispanic   AS INT64)), 0) AS total_hispanics FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file` ;"
What is the breakdown by program?,"select  year, sum(total_beneficiaries) as total_beneficiaries, round(ifnull(100 * (sum(total_beneficiaries)/lag(sum(total_beneficiaries)) over(order by year asc) - 1), 0), 2)  AS percentage_change from 
(SELECT fileyear AS year,  SUM(SAFE_CAST( Person   AS INT64)) total_beneficiaries, FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS annual_file WHERE (Program = <sq>CalWorks<sq>) group by year ORDER BY year)
 group by year order by year;"
Has this changed over time?,"select  year, sum(total_hispanic) as total_hispanic, round(ifnull(100 * (sum(total_hispanic)/lag(sum(total_hispanic)) over(order by year asc) - 1), 0), 2)  AS percentage_change from 
(SELECT fileyear AS year,  SUM(SAFE_CAST( Black   AS INT64)) total_hispanic, FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS annual_file group by year ORDER BY year)
 group by year order by year;"
Change over time by program?,"select Program, year, sum(total_hispanic) as total_hispanic, round(ifnull(100 * (sum(total_hispanic)/lag(sum(total_hispanic)) over(order by year asc) - 1), 0), 2)  AS percentage_change from 
(SELECT Program,fileyear AS year,  SUM(SAFE_CAST( Black   AS INT64)) total_hispanic, FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS annual_file group by Program,year ORDER BY Program,year)
 group by Program,year order by Program,year;"
Which counties have the highest and lowest ratios of providers to enrolled participants in IHSS?,"select annual_file.Number, (count(provider.OBJECTID )/ sum(SAFE_CAST(annual_file.person AS INT64)))  *100 as ratio
FROM `cdii-poc.HHS_Program_Counts.calhhs-dashboard-2015-2020-annual-data-file`  AS annual_file 
join `cdii-poc.HHS_Program_Counts.calhhs_ihss_managed_care_provider_listing` as provider
on annual_file.Number = provider.County
where annual_file.level = <sq>County<sq> and provider.RecordType = <sq>Provider<sq>
group by annual_file.Number
order by 2 limit 5"
How many unique products are in service?,select count(distinct PRODUCT) from `sl-test-project-353312.EY.invoice_specific` 
How many unique products are in service?,select count(distinct PRODUCT) from `sl-test-project-353312.EY.invoice_specific` 
How many unique products are in service at the organisation?,select count(distinct PRODUCT) from `sl-test-project-353312.EY.invoice_specific` 
How many employees in California are from Livingston County?,select count(*) from `sl-test-project-363109.zoominfo.zi-retail-companies-headquartered-california` where ZI_C_COMPANY_COUNTY = <sq>Livingston County<sq>
What is the revenue for pharma industry?,select * from table1 where industry=<dq>pharma<dq>
What is the revenue for pharma industry?,select * from table1 where industry=<dq>pharma<dq>
What is the revenue for manufacturing industry?,select * from table1 where industry=<dq>pharma<dq>
What is the revenue for manufacturing industry?,select * from table1 where industry=<dq>pharma<dq>
What are the top 10 industries having revenue greater than 1 million?,select * from table1 where industry=<dq>pharma<dq>
Which industry has highest revenue in Dallas county?,select revenue from table1 where county=<sq><sq>Dallas<dq> order by revenue DESC;
Testing questionn add,Select * from tab;
Testing questionn add,Select * from tab;
Testing,Testing
New question,updated sql
Testing,Testing
test,
Last question to test,Select last question
Deployed version of the  code,Select all deployed
